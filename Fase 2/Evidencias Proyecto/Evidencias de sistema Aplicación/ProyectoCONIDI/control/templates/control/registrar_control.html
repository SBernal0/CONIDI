{% extends 'base.html' %}

{% block title %}Registrar Control{% endblock %}

{% block content %}
<h2>Registro para: {{ control.nombre_control }}</h2>
<p>
    <strong>Niño/a:</strong> {{ nino.nombre }} {{ nino.ap_paterno }} <br>
    <strong>Fecha Programada:</strong> {{ control.fecha_control_programada|date:"d/m/Y" }}
</p>
<hr>

<div class="card">
    <div class="card-body">
        <form method="post">
            {% csrf_token %}

            <h5>Datos Básicos y Antropométricos</h5>
            <div class="row g-3">
                <div class="col-md-3">
                    <label for="fecha_realizacion" class="form-label">Fecha de Realización</label>
                    <input type="date" class="form-control" id="fecha_realizacion" name="fecha_realizacion" required>
                </div>
                <div class="col-md-3">
                    <label for="peso" class="form-label">Peso (kg)</label>
                    <input type="number" step="0.01" class="form-control" id="peso" name="pesokg" placeholder="Ej: 8.5" required>
                </div>
                <div class="col-md-3">
                    <label for="talla" class="form-label">Talla (cm)</label>
                    <input type="number" step="0.1" class="form-control" id="talla" name="talla_cm" placeholder="Ej: 70.5" required>
                </div>
                <div class="col-md-3">
                    <label for="pc_cm" class="form-label">Perímetro Craneal (cm)</label>
                    <input type="number" step="0.1" class="form-control" id="pc_cm" name="pc_cm" placeholder="Ej: 45.2">
                </div>
            </div>

            <hr>
            <h5>Calificaciones y Diagnósticos</h5>
            <div class="row g-3">
                <div class="col-md-4">
                    <label for="calificacion_estatural" class="form-label">Calificación Estatural</label>
                    <select id="calificacion_estatural" name="calificacion_estatural" class="form-select">
                        {% for value, display in estatural_choices %}
                            <option value="{{ value }}">{{ display }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-4">
                    <label for="calificacion_pce" class="form-label">Calificación P/CE</label>
                    <select id="calificacion_pce" name="calificacion_pce" class="form-select">
                        {% for value, display in pce_choices %}
                            <option value="{{ value }}">{{ display }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-4">
                    <label for="dig_pa" class="form-label">Diagnóstico P. Arterial</label>
                    <select id="dig_pa" name="dig_pa" class="form-select">
                        {% for value, display in pa_choices %}
                            <option value="{{ value }}">{{ display }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            <div class="row mt-3">
                 <div class="col-md-12">
                    <label for="calificacion_nutricional" class="form-label">Calificación Nutricional</label>
                    <input type="text" class="form-control" id="calificacion_nutricional" name="calificacion_nutricional">
                </div>
            </div>

            <hr>
            <h5>Observaciones e Indicaciones</h5>
            <div class="mb-3">
                <label for="diag_des_integral" class="form-label">Diagnóstico Desarrollo Integral</label>
                <textarea class="form-control" id="diag_des_integral" name="diag_des_integral" rows="3"></textarea>
            </div>
             <div class="mb-3">
                <label for="obs_desarrollo_integral" class="form-label">Observaciones Desarrollo Integral</label>
                <textarea class="form-control" id="obs_desarrollo_integral" name="obs_desarrollo_integral" rows="3"></textarea>
            </div>
            <div class="mb-3">
                <label for="observaciones" class="form-label">Observaciones Generales</label>
                <textarea class="form-control" id="observaciones" name="observaciones" rows="3"></textarea>
            </div>
            <div class="mb-3">
                <label for="indicaciones" class="form-label">Indicaciones</label>
                <textarea class="form-control" id="indicaciones" name="indicaciones" rows="3"></textarea>
            </div>

            <hr>
            <h5>Derivaciones</h5>
            <div class="row">
                <div class="col-auto">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="derivacion" name="derivacion">
                        <label class="form-check-label" for="derivacion">Requiere Derivación</label>
                    </div>
                </div>
                <div class="col-auto">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="consulta_dental" name="consulta_dental_realizada">
                        <label class="form-check-label" for="consulta_dental">Consulta Dental Realizada</label>
                    </div>
                </div>
                <div class="col-auto">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="derivacion_dentista" name="derivacion_dentista">
                        <label class="form-check-label" for="derivacion_dentista">Derivación a Dentista</label>
                    </div>
                </div>
            </div>
            
            <hr>
            <button type="submit" class="btn btn-primary">Guardar Registro</button>
            <a href="{% url 'controles' nino.rut_nino %}" class="btn btn-secondary">Cancelar</a>
        </form>
    </div>
</div>
{% endblock %}